Ennfoque "API-First" con OpenAPI (OAS) y Spring Boot.

Aqu√≠ tienes una gu√≠a paso a paso asumiendo que ya tienes tu archivo `.yaml` o `.json` de OpenAPI.

---

## üöÄ Paso 1: Crear el Proyecto en Spring Initializr

Primero, generaremos la estructura base de nuestro proyecto Spring Boot.

1. Ve a [start.spring.io](https://start.spring.io/).
    
2. Configura tu proyecto:
    
    - **Project:** Maven        
    - **Language:** Java      
    - **Spring Boot:** Elige una versi√≥n estable (ej. 3.2.x).        
    - **Project Metadata:**        
        - **Group:** `com.ejemplo` (o el de tu organizaci√≥n)       
        - **Artifact:** `mi-api-rest`            
        - **Name:** `mi-api-rest`           
        - **Package name:** `com.ejemplo.api` (¬°Importante! Usaremos este como base).
            
3. **A√±adir Dependencias:** Busca y agrega las siguientes dependencias esenciales:
    
    - **Spring Web:** Necesario para crear controladores REST.
        
    - **Spring Boot Starter Validation:** Para usar las anotaciones de validaci√≥n (ej. `@Valid`, `@NotNull`) que se generar√°n en los modelos.
        
    - **Lombok:** (Opcional, pero muy recomendado) Reduce el c√≥digo repetitivo (getters, setters, etc.) en tus modelos.
        
    - **Jackson Databind Nullable:** (Dependencia de soporte) A menudo es necesaria para manejar correctamente los campos `nullable` definidos en tu OAS.
        
4. Haz clic en **"Generate"**. Esto descargar√° un archivo `.zip`.
    
5. Descomprime el archivo y abre el proyecto en tu IDE favorito (IntelliJ, Eclipse, VSCode).
    

---

## üì¶ Paso 2: Estructura de Paquetes y OAS

Una buena organizaci√≥n es clave.

1. **Colocar el OAS:** Dentro de la carpeta `src/main/resources`, crea una nueva carpeta llamada `api`. Copia tu archivo (ej. `openapi.yaml`) dentro de ella.
    
    - Ruta final: `src/main/resources/api/openapi.yaml`
        
2. **Verificar Paquetes:** En `src/main/java`, ya tendr√°s tu paquete base (ej. `com.ejemplo.api`). Dentro de este, crea los siguientes sub-paquetes si no existen:
    
    - `com.ejemplo.api.controller` (Para nuestros controladores)
        
    - `com.ejemplo.api.model` (Aqu√≠ moveremos los modelos generados)
        
    - `com.ejemplo.api.service` (Para la l√≥gica de negocio)
        

Tu estructura deber√≠a verse as√≠:

```
mi-api-rest/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ java/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ com/ejemplo/api/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ MiApiRestApplication.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ openapi.yaml  <-- Tu archivo OAS aqu√≠
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ application.properties
‚îî‚îÄ‚îÄ pom.xml
```

---

## ‚öôÔ∏è Paso 3: Configurar `pom.xml` para Generar Modelos

Ahora, le diremos a Maven c√≥mo leer nuestro `openapi.yaml` y generar las clases POJO (Plain Old Java Objects) del modelo.

Abre tu archivo `pom.xml` en la ra√≠z del proyecto.

1. **A√±adir Dependencias (si faltaron):** Aseg√∫rate de tener estas dependencias dentro de la etiqueta `<dependencies>`:
    
    XML
    
    ```
    <dependency>
        <groupId>org.openapitools</groupId>
        <artifactId>jackson-databind-nullable</artifactId>
        <version>0.2.6</version>
    </dependency>
    
    <dependency>
        <groupId>jakarta.validation</groupId>
        <artifactId>jakarta.validation-api</artifactId>
    </dependency>
    
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-validation</artifactId>
    </dependency>
    ```
    
2. **A√±adir el Plugin Generador:** Dentro de la etiqueta `<build>`, agrega la secci√≥n `<plugins>` (si no existe) y a√±ade el siguiente plugin. Este es el motor que generar√° el c√≥digo.
    
    XML
    
    ```
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
    
            <plugin>
                <groupId>org.openapitools</groupId>
                <artifactId>openapi-generator-maven-plugin</artifactId>
                <version>7.1.0</version> <executions>
                    <execution>
                        <goals>
                            <goal>generate</goal>
                        </goals>
                        <configuration>
                            <inputSpec>${project.basedir}/src/main/resources/api/openapi.yaml</inputSpec>
    
                            <generatorName>spring</generatorName>
    
                            <modelPackage>com.ejemplo.api.model</modelPackage>
    
                            <generateModels>true</generateModels>
                            <generateApis>false</generateApis>
                            <generateSupportingFiles>false</generateSupportingFiles>
    
                            <configOptions>
                                <useJakartaEe>true</useJakartaEe> <interfaceOnly>false</interfaceOnly>
                                <skipDefaultInterface>true</skipDefaultInterface>
                                <serializableModel>true</serializableModel>
                                <useBeanValidation>true</useBeanValidation> </configOptions>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            </plugins>
    </build>
    ```
    

---

## ‚òï Paso 4: Generar y Mover los Modelos

Con el `pom.xml` configurado, vamos a generar las clases.

1. **Ejecutar Maven:** Abre una terminal en la ra√≠z de tu proyecto y ejecuta el siguiente comando:
    
    Bash
    
    ```
    mvn clean openapi-generator:generate
    ```
    
    - **Nota:** Si tus alumnos usan un IDE, pueden hacerlo desde la pesta√±a "Maven" -> "Plugins" -> "openapi-generator" -> "openapi-generator:generate".
        
2. **Verificar Archivos Generados:** Este comando _no_ pone los archivos en `src/main/java`. Los crea en la carpeta `target`. Ve a: `target/generated-sources/openapi/src/main/java/com/ejemplo/api/model`
    
3. **Mover los Modelos:**
    
    - Copia todos los archivos `.java` que encuentres en ese directorio (`Producto.java`, `Error.java`, `Usuario.java`, etc.).
        
    - P√©galos en tu paquete de c√≥digo fuente: `src/main/java/com/ejemplo/api/model`
        

¬°Listo! Ahora tu proyecto "conoce" las estructuras de datos (Modelos/POJOs) definidas en tu API. Si usas Lombok, ver√°s que las clases son limpias, solo con las anotaciones `@NotNull`, `@Size`, etc.

---

## ‚û°Ô∏è Paso 5: Crear el Controller (La L√≥gica API)

Aqu√≠ es donde implementamos los _endpoints_. El OAS nos dice _qu√©_ debemos construir, y ahora lo _construimos_.

Supongamos que tu OAS define un endpoint `POST /productos` que recibe un `Producto` y devuelve un `Producto`.

1. **Crear la Clase Controller:** En el paquete `com.ejemplo.api.controller`, crea una nueva clase Java, por ejemplo, `ProductoController.java`.
    
2. **A√±adir Anotaciones:**
    
    - `@RestController`: Le dice a Spring que esta clase manejar√° peticiones HTTP.
        
    - `@RequestMapping("/api/v1")`: (Opcional) Define un prefijo base para todas las rutas en esta clase. Debe coincidir con tu OAS.
        
    - `@Validated`: Necesario para que Spring active las validaciones en los par√°metros.
        
    
    Java
    
    ```
    package com.ejemplo.api.controller;
    
    import com.ejemplo.api.model.Producto; // <-- Importa tu modelo generado
    import org.springframework.http.HttpStatus;
    import org.springframework.http.ResponseEntity;
    import org.springframework.validation.annotation.Validated;
    import org.springframework.web.bind.annotation.*;
    
    @RestController
    @RequestMapping("/api/v1") // Prefijo base de la API
    @Validated // Activa la validaci√≥n
    public class ProductoController {
    
        // ... aqu√≠ ir√°n los m√©todos
    }
    ```
    
3. **Implementar el Endpoint (M√©todo):**
    
    - Usamos `@PostMapping("/productos")` para mapear la ruta y el m√©todo HTTP.
        
    - Usamos `@RequestBody` para indicarle a Spring que convierta el JSON de la petici√≥n en un objeto `Producto`.
        
    - Usamos `@Valid` _antes_ del `@RequestBody` para que Spring revise las anotaciones de validaci√≥n del modelo (ej. `@NotNull`) antes de que nuestro m√©todo se ejecute.
        
    - Devolvemos un `ResponseEntity<Producto>` para tener control total sobre la respuesta (c√≥digo HTTP, headers y cuerpo).
        
    
    Java
    
    ```
    // ... dentro de la clase ProductoController ...
    
    @PostMapping("/productos")
    public ResponseEntity<Producto> crearProducto(
        @Valid @RequestBody Producto productoRequest
    ) {
        // Por ahora, solo simularemos que lo guardamos
        // y le asignamos un ID
        System.out.println("Producto recibido: " + productoRequest.getNombre());
    
        // Simulamos que la DB le asigna un ID
        productoRequest.setId(1L); 
    
        // Devolvemos el producto creado con un c√≥digo 201 (CREATED)
        return new ResponseEntity<>(productoRequest, HttpStatus.CREATED);
    }
    
    @GetMapping("/productos/{id}")
    public ResponseEntity<Producto> obtenerProductoPorId(
        @PathVariable("id") Long id
    ) {
        // Simulaci√≥n: creamos un producto de prueba
        Producto productoEncontrado = new Producto();
        productoEncontrado.setId(id);
        productoEncontrado.setNombre("Producto de prueba");
        productoEncontrado.setPrecio(99.99);
    
        // Devolvemos el producto con c√≥digo 200 (OK)
        return ResponseEntity.ok(productoEncontrado);
    }
    ```
    

---

## üõ†Ô∏è Paso 6: (Opcional pero recomendado) A√±adir Capa de Servicio

Los controladores no deben tener l√≥gica de negocio (c√°lculos, acceso a base de datos). Deben delegar esa tarea a una **Capa de Servicio**.

1. **Crear `ProductoService`:** En `com.ejemplo.api.service`, crea una clase `ProductoService.java`.
    
2. **Anotar con `@Service`:** Esto le dice a Spring que gestione esta clase como un "bean".
    
    Java
    
    ```
    package com.ejemplo.api.service;
    
    import com.ejemplo.api.model.Producto;
    import org.springframework.stereotype.Service;
    
    @Service
    public class ProductoService {
    
        public Producto guardarProducto(Producto producto) {
            // Aqu√≠ ir√≠a la l√≥gica para guardar en la base de datos (ej. usando un Repository)
            System.out.println("Guardando producto en el servicio: " + producto.getNombre());
    
            // Simulamos que la DB le asigna un ID
            producto.setId(1L);
            return producto;
        }
    
        public Producto buscarProducto(Long id) {
            // Aqu√≠ ir√≠a la l√≥gica de b√∫squeda en la DB
            Producto productoEncontrado = new Producto();
            productoEncontrado.setId(id);
            productoEncontrado.setNombre("Producto de prueba desde Servicio");
            productoEncontrado.setPrecio(99.99);
            return productoEncontrado;
        }
    }
    ```
    
3. **Usar el Servicio en el Controller:** Modifica tu `ProductoController` para "inyectar" (`@Autowired`) el servicio y usarlo.
    
    Java
    
    ```
    // ... en ProductoController.java ...
    import com.ejemplo.api.service.ProductoService;
    import org.springframework.beans.factory.annotation.Autowired;
    
    @RestController
    @RequestMapping("/api/v1")
    @Validated
    public class ProductoController {
    
        // Inyecci√≥n de dependencias: Spring nos "pasa" una instancia del servicio
        @Autowired
        private ProductoService productoService;
    
        @PostMapping("/productos")
        public ResponseEntity<Producto> crearProducto(
            @Valid @RequestBody Producto productoRequest
        ) {
            // El controller delega la l√≥gica al servicio
            Producto productoGuardado = productoService.guardarProducto(productoRequest);
    
            return new ResponseEntity<>(productoGuardado, HttpStatus.CREATED);
        }
    
        @GetMapping("/productos/{id}")
        public ResponseEntity<Producto> obtenerProductoPorId(
            @PathVariable("id") Long id
        ) {
            // El controller delega la l√≥gica al servicio
            Producto productoEncontrado = productoService.buscarProducto(id);
    
            return ResponseEntity.ok(productoEncontrado);
        }
    }
    ```
    

---

## üß™ Paso 7: Probar con Postman

¬°Es la hora de la verdad!

1. **Ejecutar la Aplicaci√≥n:** Ejecuta tu clase principal `MiApiRestApplication.java` (o usa `mvn spring-boot:run`).
    
2. **Abrir Postman.**
    
3. **Probar el `POST /productos`:**
    
    - **M√©todo:** `POST`
        
    - **URL:** `http://localhost:8080/api/v1/productos`
        
    - **Pesta√±a "Body"**:
        
        - Selecciona `raw` y `JSON`.
            
        - Escribe el JSON de tu producto (¬°los nombres deben coincidir con tu modelo!).
            
        
        JSON
        
        ```
        {
          "nombre": "Mi Primer Producto",
          "precio": 150.75,
          "categoria": "tecnologia"
        }
        ```
        
    - **¬°Enviar!** Deber√≠as recibir una respuesta `201 Created` con el JSON del producto, ahora incluyendo el ID "1".
        
4. **Probar el `GET /productos/{id}`:**
    
    - **M√©todo:** `GET`
        
    - **URL:** `http://localhost:8080/api/v1/productos/1` (o el ID que quieras probar).
        
    - **¬°Enviar!** Deber√≠as recibir una respuesta `200 OK` con el JSON del producto de prueba.